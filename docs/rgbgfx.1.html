<section class="Sh">
<h2 class="Sh" id="SYNOPSIS"><a class="permalink" href="#SYNOPSIS">SYNOPSIS</a></h2>
<table class="Nm">
  <tr>
    <td><code class="Nm">rgbgfx</code></td>
    <td>[<code class="Fl"><a href="#r">-r</a></code> <var class="Ar">stride</var>]
      [<code class="Fl"><a href="#C">-C</a><a href="#m">m</a><a href="#u">u</a><a href="#V">V</a><a href="#Z">Z</a></code>] [<code class="Fl"><a href="#v">-v</a></code>
      [<code class="Fl"><a href="#v">-v</a></code> <span class="No">...</span>]]
      [<code class="Fl"><a href="#a">-a</a></code> <var class="Ar">attrmap</var> |
      <code class="Fl"><a href="#A">-A</a></code>] [<code class="Fl"><a href="#b">-b</a></code>
      <var class="Ar">base_ids</var>] [<code class="Fl"><a href="#c">-c</a></code>
      <var class="Ar">color_spec</var>] [<code class="Fl"><a href="#d">-d</a></code>
      <var class="Ar">depth</var>] [<code class="Fl"><a href="#L">-L</a></code>
      <var class="Ar">slice</var>] [<code class="Fl"><a href="#N">-N</a></code>
      <var class="Ar">nb_tiles</var>] [<code class="Fl"><a href="#n">-n</a></code>
      <var class="Ar">nb_pals</var>] [<code class="Fl"><a href="#o">-o</a></code>
      <var class="Ar">out_file</var>] [<code class="Fl"><a href="#p">-p</a></code>
      <var class="Ar">pal_file</var> | <code class="Fl"><a href="#P">-P</a></code>]
      [<code class="Fl"><a href="#q">-q</a></code> <var class="Ar">pal_map</var> |
      <code class="Fl"><a href="#Q">-Q</a></code>] [<code class="Fl"><a href="#s">-s</a></code>
      <var class="Ar">nb_colors</var>] [<code class="Fl"><a href="#t">-t</a></code>
      <var class="Ar">tilemap</var> | <code class="Fl"><a href="#T">-T</a></code>]
      [<code class="Fl"><a href="#x">-x</a></code> <var class="Ar">quantity</var>]
      <var class="Ar">file</var></td>
  </tr>
</table>
</section>
<section class="Sh">
<h2 class="Sh" id="DESCRIPTION"><a class="permalink" href="#DESCRIPTION">DESCRIPTION</a></h2>
<p class="Pp">The <code class="Nm">rgbgfx</code> program converts PNG images
    into data suitable for display on the Game Boy and Game Boy Color, or
    vice-versa.</p>
<p class="Pp" id="squares">The main function of <code class="Nm">rgbgfx</code>
    is to divide the input PNG into 8&#x00D7;8 pixel
    <a class="permalink" href="#squares"><i class="Em">squares</i></a>, convert
    each of those squares into 1bpp or 2bpp tile data, and save all of the tile
    data in a file. It also has options to generate a tile map, attribute map,
    and/or palette set as well; more on that and how the conversion process can
    be tweaked below.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="ARGUMENTS"><a class="permalink" href="#ARGUMENTS">ARGUMENTS</a></h2>
<p class="Pp">Note that options can be abbreviated as long as the abbreviation
    is unambiguous: <code class="Fl">--verb</code> is
    <code class="Fl">--verbose</code>, but <code class="Fl">--ver</code> is
    invalid because it could also be <code class="Fl">--version</code>.</p>
<p class="Pp"><code class="Nm">rgbgfx</code> accepts decimal, binary, and
    hexadecimal numbers in option arguments. Decimal numbers are written as
    usual; binary numbers must be prefixed with either
    &#x2018;<code class="Li">%</code>&#x2019; or
    &#x2018;<code class="Li">0b</code>&#x2019;, and hexadecimal numbers must be
    prefixed with either &#x2018;<code class="Li">$</code>&#x2019; (which will
    likely need escaping or quoting to avoid being interpreted by the shell), or
    &#x2018;<code class="Li">0x</code>&#x2019;. Leading zeros (after the base
    prefix, if any) are accepted, and letters are not case-sensitive. All of
    these are equivalent: &#x2018;<code class="Li">42</code>&#x2019;,
    &#x2018;<code class="Li">042</code>&#x2019;,
    &#x2018;<code class="Li">0b00101010</code>&#x2019;,
    &#x2018;<code class="Li">0B101010</code>&#x2019;,
    &#x2018;<code class="Li">0x2A</code>&#x2019;,
    &#x2018;<code class="Li">0X2A</code>&#x2019;,
    &#x2018;<code class="Li">0x2a</code>&#x2019;.</p>
<p class="Pp">The following options are accepted:</p>
<dl class="Bl-tag">
  <dt id="a"><a class="permalink" href="#a"><code class="Fl">-a</code></a>
    <var class="Ar">attrmap</var>, <code class="Fl">--attr-map</code>
    <var class="Ar">attrmap</var></dt>
  <dd>Generate an attribute map, which is a file containing tile
      &#x201C;attributes&#x201D;. For each square of the input image, its
      corresponding attribute map byte contains the mirroring bits (if
      <code class="Fl">-m</code> was specified), the bank bit (see
      <code class="Fl">-N</code>), and the palette index. See
      <a class="Lk" href="https://gbdev.io/pandocs/Tile_Maps#bg-map-attributes-cgb-mode-only">Pan
      Docs</a> for the individual bytes' format. The output is written just like
      the tile map (see <code class="Fl">-t</code>), follows the same order
      (<code class="Fl">-Z</code>), and has the same size.</dd>
  <dt id="A"><a class="permalink" href="#A"><code class="Fl">-A</code></a>,
    <code class="Fl">--output-attr-map</code></dt>
  <dd>Same as <code class="Fl">-a</code> <var class="Ar">path</var>, where
      <var class="Ar">path</var> is the input image's path with the extension
      set to <span class="Pa">.attrmap</span>.</dd>
  <dt id="b"><a class="permalink" href="#b"><code class="Fl">-b</code></a>
    <var class="Ar">base_ids</var>, <code class="Fl">--base-tiles</code>
    <var class="Ar">base_ids</var></dt>
  <dd>Set the base IDs for tile map output. <var class="Ar">base_ids</var>
      should be one or two numbers between 0 and 255, separated by a comma; they
      are for bank 0 and bank 1 respectively. Both default to 0.</dd>
  <dt id="C"><a class="permalink" href="#C"><code class="Fl">-C</code></a>,
    <code class="Fl">--color-curve</code></dt>
  <dd>When generating palettes, use a color curve mimicking the Game Boy Color's
      screen. The resulting colors may look closer to the input image's
      <a class="permalink" href="#on"><b class="Sy" id="on">on hardware and
      accurate emulators</b></a>.</dd>
  <dt id="c"><a class="permalink" href="#c"><code class="Fl">-c</code></a>
    <var class="Ar">color_spec</var>, <code class="Fl">--colors</code>
    <var class="Ar">color_spec</var></dt>
  <dd>Use the specified color palettes instead of having
      <code class="Nm">rgbgfx</code> automatically determine some.
      <var class="Ar">color_spec</var> can be one of the following:
    <dl class="Bl-tag">
      <dt id="inline"><a class="permalink" href="#inline"><b class="Sy">inline
        palette spec</b></a></dt>
      <dd>If <var class="Ar">color_spec</var> begins with a hash character
          &#x2018;<code class="Li">#</code>&#x2019;, it is treated as an inline
          palette specification. It should contain a comma-separated list of
          hexadecimal colors, each beginning with a hash. Colors in are accepted
          either as &#x2018;<code class="Li">#rgb</code>&#x2019; or
          &#x2018;<code class="Li">#rrggbb</code>&#x2019; format. Palettes must
          be separated by a colon or semicolon (the latter may require quoting
          to avoid special handling by the shell), and spaces are allowed around
          colons, semicolons and commas; trailing commas and semicolons are
          allowed. See <a class="Sx" href="#EXAMPLES">EXAMPLES</a> for an
          example of an inline palette specification.</dd>
      <dt id="embedded"><a class="permalink" href="#embedded"><b class="Sy">embedded
        palette spec</b></a></dt>
      <dd>If <var class="Ar">color_spec</var> is the case-insensitive word
          <code class="Cm">embedded</code>, then the first four colors of the
          input PNG's embedded palette are used. It is an error if the PNG is
          not indexed, or if colors other than these 4 are used. (This is
          different from the default behavior of indexed PNGs, as then unused
          entries in the embedded palette are ignored, whereas they are not with
          <code class="Fl">-c</code> <code class="Cm">embedded</code>).</dd>
      <dt id="external"><a class="permalink" href="#external"><b class="Sy">external
        palette spec</b></a></dt>
      <dd>Otherwise, <var class="Ar">color_spec</var> is assumed to be an
          external palette specification. The expected format is
          &#x2018;<code class="Li">format:path</code>&#x2019;, where
          <var class="Ar">path</var> is a path to a file, which will be
          processed according to the <var class="Ar">format</var>. See
          <a class="Sx" href="#PALETTE_SPECIFICATION_FORMATS">PALETTE
          SPECIFICATION FORMATS</a> for a list of formats and their
          descriptions.</dd>
    </dl>
  </dd>
  <dt id="d"><a class="permalink" href="#d"><code class="Fl">-d</code></a>
    <var class="Ar">depth</var>, <code class="Fl">--depth</code>
    <var class="Ar">depth</var></dt>
  <dd>Set the bit depth of the output tile data, in bits per pixel (bpp), either
      1 or 2 (the default). This changes how tile data is output, and the
      maximum number of colors per palette (2 and 4 respectively).</dd>
  <dt id="L"><a class="permalink" href="#L"><code class="Fl">-L</code></a>
    <var class="Ar">slice</var>, <code class="Fl">--slice</code>
    <var class="Ar">slice</var></dt>
  <dd>Only process a given rectangle of the image. This is useful for example if
      the input image is a sheet of some sort, and you want to convert each cel
      individually. The default is to process the whole image as-is.
    <p class="Pp"><var class="Ar">slice</var> must be two number pairs,
        separated by a colon. The numbers must be separated by commas; space is
        allowed around all punctuation. The first number pair specifies the X
        and Y coordinates of the top-left pixel that will be processed (anything
        above it or to its left will be ignored). The second number pair
        specifies how many tiles to process horizontally and vertically,
        respectively.</p>
    <p class="Pp" id="is"><code class="Fl">-L</code>
        <a class="permalink" href="#is"><b class="Sy">is ignored in reverse
        mode</b></a>, <span class="No">no padding is inserted</span>.</p>
  </dd>
  <dt id="m"><a class="permalink" href="#m"><code class="Fl">-m</code></a>,
    <code class="Fl">--mirror-tiles</code></dt>
  <dd>Deduplicate tiles that are mirrors of each other. Tiles are checked for
      horizontal, vertical, and horizontal-vertical mirroring. Useful with a
      tile map and attribute map together to keep track of the duplicated tiles
      and the dimension(s) mirrored. Implies <code class="Fl">-u</code>.</dd>
  <dt id="N"><a class="permalink" href="#N"><code class="Fl">-N</code></a>
    <var class="Ar">nb_tiles</var>, <code class="Fl">--nb-tiles</code>
    <var class="Ar">nb_tiles</var></dt>
  <dd>Set a maximum number of tiles that can be placed in each VRAM bank.
      <var class="Ar">nb_tiles</var> should be one or two numbers between 0 and
      256, separated by a comma; if the latter is omitted, it defaults to 0.
      Setting either number to 0 prevents any tiles from being output in that
      bank.
    <p class="Pp">If more tiles are generated than can fit in the two banks
        combined, <code class="Nm">rgbgfx</code> will abort. If
        <code class="Fl">-N</code> is not specified, no limit will be set on the
        amount of tiles placed in bank 0, and tiles will not be placed in bank
        1.</p>
  </dd>
  <dt id="n"><a class="permalink" href="#n"><code class="Fl">-n</code></a>
    <var class="Ar">nb_pals</var>, <code class="Fl">--nb-palettes</code>
    <var class="Ar">nb_pals</var></dt>
  <dd>Abort if more than <var class="Ar">nb_pals</var> palettes are generated.
      This may not be more than 256.
    <p class="Pp">Note that attribute map output only has 3 bits for the palette
        ID, so a limit higher than 8 may yield incomplete data unless relying on
        a palette map (see <code class="Fl">-q</code>).</p>
  </dd>
  <dt id="o"><a class="permalink" href="#o"><code class="Fl">-o</code></a>
    <var class="Ar">out_file</var>, <code class="Fl">--output</code>
    <var class="Ar">out_file</var></dt>
  <dd>Output the tile data in native 2bpp format or in 1bpp (depending on
      <code class="Fl">-d</code>) to this file.</dd>
  <dt id="p"><a class="permalink" href="#p"><code class="Fl">-p</code></a>
    <var class="Ar">pal_file</var>, <code class="Fl">--palette</code>
    <var class="Ar">pal_file</var></dt>
  <dd>Output the image's palette set to this file.</dd>
  <dt id="P"><a class="permalink" href="#P"><code class="Fl">-P</code></a>,
    <code class="Fl">--output-palette</code></dt>
  <dd>Same as <code class="Fl">-p</code> <var class="Ar">path</var>, where
      <var class="Ar">path</var> is the input image's path with the extension
      set to <span class="Pa">.pal</span>.</dd>
  <dt id="q"><a class="permalink" href="#q"><code class="Fl">-q</code></a>
    <var class="Ar">pal_file</var>, <code class="Fl">--palette-map</code>
    <var class="Ar">pal_file</var></dt>
  <dd>Output the image's palette map to this file. This is useful if the input
      image contains more than 8 palettes, as the attribute map only contains
      the lower 3 bits of the palette indices.</dd>
  <dt id="Q"><a class="permalink" href="#Q"><code class="Fl">-Q</code></a>,
    <code class="Fl">--output-palette-map</code></dt>
  <dd>Same as <code class="Fl">-q</code> <var class="Ar">path</var>, where
      <var class="Ar">path</var> is the input image's path with the extension
      set to <span class="Pa">.palmap</span>.</dd>
  <dt id="r"><a class="permalink" href="#r"><code class="Fl">-r</code></a>
    <var class="Ar">width</var>, <code class="Fl">--reverse</code>
    <var class="Ar">width</var></dt>
  <dd>Switches <code class="Nm">rgbgfx</code> into
      &#x201C;<a class="permalink" href="#reverse"><b class="Sy" id="reverse">reverse</b></a>&#x201D;
      mode. In this mode, instead of converting a PNG image into Game Boy data,
      <code class="Nm">rgbgfx</code> will attempt to reverse the process, and
      render Game Boy data into an image. See
      <a class="Sx" href="#REVERSE_MODE">REVERSE MODE</a> below for details.
    <p class="Pp"><var class="Ar">width</var> is the image's width, in tiles
        (including any margins specified by <code class="Fl">-L</code>).</p>
  </dd>
  <dt id="s"><a class="permalink" href="#s"><code class="Fl">-s</code></a>
    <var class="Ar">nb_colors</var>, <code class="Fl">--palette-size</code>
    <var class="Ar">nb_colors</var></dt>
  <dd>Specify how many colors each palette contains, including the transparent
      one if any. <var class="Ar">nb_colors</var> cannot be more than
      &#x2018;<code class="Li">1 &lt;&lt;
      <var class="Ar">depth</var></code>&#x2019; (see
      <code class="Fl">-d</code>).</dd>
  <dt id="t"><a class="permalink" href="#t"><code class="Fl">-t</code></a>
    <var class="Ar">tilemap</var>, <code class="Fl">--tilemap</code>
    <var class="Ar">tilemap</var></dt>
  <dd>Generate a file of tile indices. For each square of the input image, its
      corresponding tile map byte contains the index of the associated tile in
      the tile data file. The IDs wrap around from 255 back to 0, and do not
      include the bank bit; use <code class="Fl">-a</code> for that. Useful in
      combination with <code class="Fl">-u</code> and/or
      <code class="Fl">-m</code> to keep track of duplicate tiles.</dd>
  <dt id="T"><a class="permalink" href="#T"><code class="Fl">-T</code></a>,
    <code class="Fl">--output-tilemap</code></dt>
  <dd>Same as <code class="Fl">-t</code> <var class="Ar">path</var>, where
      <var class="Ar">path</var> is the input image's path with the extension
      set to <span class="Pa">.tilemap</span>.</dd>
  <dt id="u"><a class="permalink" href="#u"><code class="Fl">-u</code></a>,
    <code class="Fl">--unique-tiles</code></dt>
  <dd>Deduplicate identical tiles, and omit the duplicates from the tile data
      file. Useful with a tile map (see <code class="Fl">-t</code>) to keep
      track of the duplicated tiles.
    <p class="Pp" id="should">Note that if this option is enabled, no guarantee
        is made on the order in which tiles are output; while it
        <a class="permalink" href="#should"><i class="Em">should</i></a> be
        consistent across identical runs of a given
        <code class="Nm">rgbgfx</code> release, the same is not true for
        different releases.</p>
  </dd>
  <dt id="V"><a class="permalink" href="#V"><code class="Fl">-V</code></a>,
    <code class="Fl">--version</code></dt>
  <dd>Print the version of the program and exit.</dd>
  <dt id="v"><a class="permalink" href="#v"><code class="Fl">-v</code></a>,
    <code class="Fl">--verbose</code></dt>
  <dd>Be verbose. The verbosity level is increased by one each time the flag is
      specified, with each level including the previous:
    <ol class="Bl-enum Bl-compact">
      <li><code class="Nm">rgbgfx</code> prints out its configuration before
          doing anything.</li>
      <li>A generic message is printed before doing most actions.</li>
      <li>Some of the actions' intermediate results are printed.</li>
      <li>Some internal debug printing is enabled.</li>
    </ol>
    The verbosity level does not go past 6.
    <p class="Pp">Note that verbose output is only intended to be consumed by
        humans, and may change without notice between RGBDS releases; relying on
        those for scripts is not advised.</p>
  </dd>
  <dt id="x"><a class="permalink" href="#x"><code class="Fl">-x</code></a>
    <var class="Ar">quantity</var>, <code class="Fl">--trim-end</code>
    <var class="Ar">quantity</var></dt>
  <dd>Do not output the last <var class="Ar">quantity</var> tiles to the tile
      data file; no other output is affected. This is useful for trimming
      &#x201C;filler&#x201D; / blank squares at the end of an image. If fewer
      than <var class="Ar">quantity</var> tiles would have been emitted, the
      file will be empty.
    <p class="Pp" id="after">Note that this is done
        <a class="permalink" href="#after"><i class="Em">after</i></a>
        deduplication if <code class="Fl">-u</code> was enabled, so you probably
        don't want to use this option in combination with
        <code class="Fl">-u</code>. Note also that the tiles that don't get
        output will not count towards <code class="Fl">-N</code>'s limit.</p>
  </dd>
  <dt id="Z"><a class="permalink" href="#Z"><code class="Fl">-Z</code></a>,
    <code class="Fl">--columns</code></dt>
  <dd>Read squares from the PNG in column-major order (column by column),
      instead of the default row-major order (line by line). This primarily
      affects tile map and attribute map output, although it may also change
      generated tile data and palettes.</dd>
</dl>
<section class="Ss">
<h3 class="Ss" id="At-files"><a class="permalink" href="#At-files">At-files</a></h3>
<p class="Pp">In a given project, many images are to be converted with different
    flags. The traditional way of solving this problem has been to specify the
    different flags for each image in the Makefile / build script; this can be
    inconvenient, as it centralizes all those flags away from the images they
    concern.</p>
<p class="Pp">To avoid these drawbacks, <code class="Nm">rgbgfx</code> supports
    &#x201C;at-files&#x201D;: any command-line argument that begins with an at
    sign (&#x2018;<code class="Li">@</code>&#x2019;) is interpreted as one. The
    rest of the argument (without the @, that is) is interpreted as the path to
    a file, whose contents are interpreted as if given on the command line.
    At-files can be stored right next to the corresponding image, for
  example:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">$ rgbgfx -o image.2bpp -t
  image.tilemap @image.flags image.png</code></div>
<p class="Pp">This will read additional flags from file
    &#x2018;<code class="Li">image.flags</code>&#x2019;, which could contains
    for example &#x2018;<code class="Li">-b 128</code>&#x2019; to specify a base
    offset for the image's tiles. The above command could be generated from the
    following
    <a class="Xr" href="https://man7.org/linux/man-pages/man1/make.1.html">make(1)</a>
    rule, for example:</p>
<div class="Bd Pp Bd-indent Li">
<pre>%.2bpp %.tilemap: %.flags %.png
	rgbgfx -o $*.2bpp -t $*.tilemap @$*.flags $*.png</pre>
</div>
<p class="Pp" id="no">Since the contents of at-files are interpreted by
    <code class="Nm">rgbgfx</code>,
    <a class="permalink" href="#no"><b class="Sy">no shell processing is
    performed</b></a>; for example, shell variables are not expanded
    (&#x2018;<code class="Li">$PWD</code>&#x2019;,
    &#x2018;<code class="Li">%WINDIR%</code>&#x2019;, etc.). In at-files, lines
    that are empty or contain only whitespace are ignored; lines that begin with
    a hash sign (&#x2018;<code class="Li">#</code>&#x2019;), optionally preceded
    by whitespace, are considered comments and also ignored. Each line can
    contain any number of arguments, which are separated by whitespace. (No
    quoting feature to prevent this is provided.)</p>
<p class="Pp">Note that a leading &#x2018;<code class="Li">@</code>&#x2019; has
    no special meaning on option arguments, and that the standard
    &#x2018;<code class="Li">--</code>&#x2019; to stop option processing also
    disables at-file processing. For example, the following command line reads
    command-line options from
    &#x2018;<code class="Li">tilesets/town.flags</code>&#x2019; then
    &#x2018;<code class="Li">tilesets.flags</code>&#x2019;, but processes
    &#x2018;<code class="Li">@tilesets/town.png</code>&#x2019; as the input
    image and outputs tile data to
    &#x2018;<code class="Li">@tilesets/town.2bpp</code>&#x2019;:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">$ rgbgfx -o @tilesets/town.2bpp
  @tilesets/town.flags @tilesets.flags -- @tilesets/town.png</code></div>
<p class="Pp">At-files can also specify the input image directly, and call for
    more at-files, both using the regular syntax. Note that while
    &#x2018;<code class="Li">--</code>&#x2019; can be used in an at-file (with
    identical semantics), it is only effective inside of it&#x2014;normal option
    processing continues in the parent scope.</p>
</section>
</section>
<section class="Sh">
<h2 class="Sh" id="PALETTE_SPECIFICATION_FORMATS"><a class="permalink" href="#PALETTE_SPECIFICATION_FORMATS">PALETTE
  SPECIFICATION FORMATS</a></h2>
<p class="Pp">The following formats are supported:</p>
<dl class="Bl-tag">
  <dt id="act"><a class="permalink" href="#act"><b class="Sy">act</b></a></dt>
  <dd><a class="Lk" href="https://www.adobe.com/devnet-apps/photoshop/fileformatashtml/#50577411_pgfId-1070626">Adobe
      Photoshop color table</a>.</dd>
  <dt id="aco"><a class="permalink" href="#aco"><b class="Sy">aco</b></a></dt>
  <dd><a class="Lk" href="https://www.adobe.com/devnet-apps/photoshop/fileformatashtml/#50577411_pgfId-1055819">Adobe
      Photoshop color swatch</a>.</dd>
  <dt id="psp"><a class="permalink" href="#psp"><b class="Sy">psp</b></a></dt>
  <dd><a class="Lk" href="https://www.selapa.net/swatches/colors/fileformats.php#psp_pal">Paint
      Shop Pro palette</a>.</dd>
  <dt id="gpl"><a class="permalink" href="#gpl"><b class="Sy">gpl</b></a></dt>
  <dd><a class="Lk" href="https://docs.gimp.org/2.10/en/gimp-concepts-palettes.html">GIMP
      palette</a>.</dd>
</dl>
<p class="Pp">If you wish for another format to be supported, please open an
    issue (see <a class="Sx" href="#BUGS">BUGS</a> below) or contact us, and
    supply a few sample files.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="PALETTE_GENERATION"><a class="permalink" href="#PALETTE_GENERATION">PALETTE
  GENERATION</a></h2>
<p class="Pp"><code class="Nm">rgbgfx</code> must generate palettes from the
    colors in the input image, unless <code class="Fl">-c</code> was used; in
    that case, the provided palettes will be used.
    <a class="permalink" href="#If"><b class="Sy" id="If">If the order of colors
    in the palettes is important to you</b></a>, for example because you want to
    use palette swaps, please use <code class="Fl">-c</code> to specify the
    palette explicitly.</p>
<p class="Pp" id="any">First, if the image contains
    <a class="permalink" href="#any"><i class="Em">any</i></a> transparent
    pixel, color #0 of <i class="Em">all</i> palettes will be allocated to it.
    This is done <a class="permalink" href="#even"><b class="Sy" id="even">even
    if palettes were explicitly specified using</b></a>
    <code class="Fl">-c</code>; then the specification only covers color #1
    onwards. (If you do not want this, ask your image editor to remove the alpha
    channel.)</p>
<p class="Pp">After generating palettes, <code class="Nm">rgbgfx</code> sorts
    colors within those palettes using the following rules:</p>
<ul class="Bl-bullet Bd-indent">
  <li>If the PNG file internally contains a palette (often dubbed an
      &#x201C;indexed&#x201D; PNG), then colors in each output palette will be
      sorted according to their order in the PNG's palette. Any unused entries
      will be ignored, and only the first entry is considered if there are any
      duplicates. (If you want a given color to appear more than once, or an
      unused color to appear at all, you should specify the palettes explicitly
      instead using <code class="Fl">-c</code>; <code class="Fl">-c</code>
      <code class="Cm">embedded</code> may be appropriate.)</li>
  <li>Otherwise, if the PNG only contains shades of gray, they will be
      categorized into as many &#x201C;bins&#x201D; as there are colors per
      palette, and the palette is set to these bins. The darkest gray will end
      up in bin #0, and so on; note that this is the opposite of the RGB method
      below. If two distinct grays end up in the same bin, the RGB method is
      used instead.
    <p class="Pp" id="exactly">Be careful that <code class="Nm">rgbgfx</code> is
        picky about what it considers &#x201C;grays&#x201D;: the red, green, and
        blue components of each color must <i class="Em">all</i> be
        <a class="permalink" href="#exactly"><i class="Em">exactly</i></a> the
        same.</p>
  </li>
  <li>If none of the above apply, colors are sorted from lightest (first) to
      darkest (last). The definition of luminance that
      <code class="Nm">rgbgfx</code> uses is &#x201C;
    <math class="eqn">
      <mrow><mn>2126</mn><mo>&#x00D7;</mo><mi fontstyle="italic">red</mi><mo>+</mo><mn>7152</mn><mo>&#x00D7;</mo><mi fontstyle="italic">green</mi><mo>+</mo><mn>722</mn><mo>&#x00D7;</mo><mi fontstyle="italic">blue</mi></mrow>
    </math>
    &#x201D;.</li>
</ul>
<p class="Pp">Note that the &#x201C;indexed&#x201D; behavior depends on an
    internal detail of how the PNG is saved, specifically its
    &#x2018;<code class="Li">PLTE</code>&#x2019; chunk. Since few image editors
    (such as GIMP) expose that detail, this behavior is only kept for
    compatibility and should be considered deprecated.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="OUTPUT_FILES"><a class="permalink" href="#OUTPUT_FILES">OUTPUT
  FILES</a></h2>
<p class="Pp">All files output by <code class="Nm">rgbgfx</code> are binary
    files, and designed to follow the Game Boy and Game Boy Color's native
    formats. What follows is succinct descriptions of those formats, including
    <code class="Nm">rgbgfx</code>-specific details. For more complete,
    beginner-friendly descriptions of the native formats with illustrations,
    please check out <a class="Lk" href="https://gbdev.io/pandocs/Rendering">Pan
    Docs</a>.</p>
<section class="Ss">
<h3 class="Ss" id="Tile_data"><a class="permalink" href="#Tile_data">Tile
  data</a></h3>
<p class="Pp">Tile data is output like a binary dump of VRAM, with no padding
    between tiles. Each tile is 16 bytes, 2 per row of 8 pixels; the bits of
    color IDs are split into each byte (or &#x201C;bitplane&#x201D;). The
    leftmost pixel's color ID is stored in the two bytes' most significant bits,
    and the rightmost pixel's color ID in their least significant bits.</p>
<p class="Pp">When the bit depth (<code class="Fl">-d</code>) is set to 1, the
    most significant bitplane (second byte) of each row, being all zeros, is
    simply not output.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Palette_data"><a class="permalink" href="#Palette_data">Palette
  data</a></h3>
<p class="Pp">Palette data is output like a dump of palette memory. Each color
    is written as GBC-native little-endian RGB555, with the unused bit 15 set to
    0. There is no padding between colors, nor between palettes; however, empty
    colors in the palettes are output as 0xFFFF. For example, if 5 palettes are
    generated with <code class="Fl">-s</code> <code class="Cm">4</code>, the
    palette data file will be
  <math class="eqn">
    <mrow><mn>2</mn><mo>&#x00D7;</mo><mn>4</mn><mo>&#x00D7;</mo><mn>5</mn><mo>=</mo><mn>40</mn></mrow>
  </math>
   bytes long, even if some palettes contain less than 3 colors. Note that
    <code class="Fl">-n</code> only caps how many palettes are generated (and
    thus this file's size), but fewer may be generated still.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Tile_map_data"><a class="permalink" href="#Tile_map_data">Tile
  map data</a></h3>
<p class="Pp">A tile map is an array of tile IDs, with one byte per tile ID. The
    first byte always corresponds to the ID of the tile in top-left corner of
    the input image; the second byte is either the ID of the tile to its right
    (by default), or below it (with <code class="Fl">-Z</code>); and so on,
    continuing in the same direction. Rows / columns (respectively) are stored
    consecutively, with no padding.</p>
</section>
<section class="Ss">
<h3 class="Ss" id="Attribute_map_data"><a class="permalink" href="#Attribute_map_data">Attribute
  map data</a></h3>
<p class="Pp">Attribute maps mirror the format of tile maps, like on the GBC,
    especially the order in which bytes are output. The contents of individual
    bytes follows the GBC's native format:</p>
<table class="Bl-column">
  <tr>
    <td>Bit 7</td>
    <td>BG-to-OAM Priority</td>
    <td>Set to 0</td>
  </tr>
  <tr>
    <td>Bit 6</td>
    <td>Vertical Flip</td>
    <td>0=Normal, 1=Mirror vertically</td>
  </tr>
  <tr>
    <td>Bit 5</td>
    <td>Horizontal Flip</td>
    <td>0=Normal, 1=Mirror horizontally</td>
  </tr>
  <tr>
    <td>Bit 4</td>
    <td>Not used</td>
    <td>Set to 0</td>
  </tr>
  <tr>
    <td>Bit 3</td>
    <td>Tile VRAM Bank number</td>
    <td>0=Bank 0, 1=Bank 1</td>
  </tr>
  <tr>
    <td>Bit 2&#x2013;0</td>
    <td>Background Palette number</td>
    <td>BGP0-7</td>
  </tr>
</table>
<p class="Pp">Note that if more than 8 palettes are used, only the lowest 3 bits
    of the palette ID are output.</p>
</section>
</section>
<section class="Sh">
<h2 class="Sh" id="REVERSE_MODE"><a class="permalink" href="#REVERSE_MODE">REVERSE
  MODE</a></h2>
<p class="Pp"><code class="Nm">rgbgfx</code> can produce a PNG image from valid
    data. This may be useful for ripping graphics, recovering lost source
    images, etc. An important caveat on that last one, though: the conversion
    process is
    <a class="permalink" href="#lossy"><b class="Sy" id="lossy">lossy</b></a>
    both ways, so the &#x201C;reversed&#x201D; image won't be perfectly
    identical to the original&#x2014;but it should be close to a Game Boy's
    output. (Keep in mind that many of consoles output different colors, so
    there is no true reference rendering.)</p>
<p class="Pp">When using reverse mode, make sure to pass the same flags that
    were given when generating the data, especially <code class="Fl">-C</code>,
    <code class="Fl">-d</code>, <code class="Fl">-N</code>,
    <code class="Fl">-s</code>, <code class="Fl">-x</code>, and
    <code class="Fl">-Z</code>.
    &#x201C;<a class="Sx" href="#At_files">At-files</a>&#x201D; may help with
    this. <code class="Nm">rgbgfx</code> will warn about any inconsistencies it
    detects.</p>
<p class="Pp">Files that are normally outputs (<code class="Fl">-a</code>,
    <code class="Fl">-p</code>, <code class="Fl">-t</code>) become inputs, and
    <var class="Ar">file</var> will be written to instead of read from, and thus
    needs not exist beforehand. Any of these inputs not passed is assumed to be
    some default:</p>
<table class="Bl-column">
  <tr>
    <td>palettes</td>
    <td>Unspecified palette data makes <code class="Nm">rgbgfx</code> assume DMG
      (monochrome Game Boy) mode: a single palette of 4 grays. It is possible to
      pass palettes using <code class="Fl">-c</code> instead of
      <code class="Fl">-p</code>.</td>
  </tr>
  <tr>
    <td>tile data</td>
    <td>Tile data must be provided, as there is no reasonable assumption to fall
      back on.</td>
  </tr>
  <tr>
    <td>tile map</td>
    <td>A missing tile map makes <code class="Nm">rgbgfx</code> assume that
      tiles were not deduplicated, and should be laid out in the order they are
      stored.</td>
  </tr>
  <tr>
    <td>attribute map</td>
    <td>Without an attribute map, <code class="Nm">rgbgfx</code> assumes that no
      tiles were mirrored.</td>
  </tr>
</table>
</section>
<section class="Sh">
<h2 class="Sh" id="NOTES"><a class="permalink" href="#NOTES">NOTES</a></h2>
<p class="Pp">Some flags have had their functionality removed.
    <code class="Fl">-D</code>, <code class="Fl">-f</code>, and
    <code class="Fl">-F</code> are now ignored, and <code class="Fl">-h</code>
    is an alias for the new (and less confusingly named)
    <code class="Fl">-Z</code>. These will be removed and/or repurposed in
    future versions of <code class="Nm">rgbgfx</code>, so relying on them is not
    recommended. The same applies to the corresponding long options.</p>
<p class="Pp">If you are curious, you may find out that palette generation is an
    NP-complete problem, so <code class="Nm">rgbgfx</code> does not attempt to
    find the optimal solution, but instead to find a good one in a reasonable
    amount of time. It is possible to compute the optimal solution externally
    (using a solver, for example), and then provide it to
    <code class="Nm">rgbgfx</code> via <code class="Fl">-c</code>.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="EXAMPLES"><a class="permalink" href="#EXAMPLES">EXAMPLES</a></h2>
<p class="Pp">The following will only validate the PNG (check its size, that all
    tiles have a suitable amount of colors, etc.), but output nothing:</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">$ rgbgfx
  src/res/maps/overworld/tileset.png</code></div>
<p class="Pp">The following will convert the image using the two given palettes
    (and only those), and store the generated 2bpp tile data in
    &#x2018;<code class="Li">tileset.2bpp</code>&#x2019;, and the attribute map
    in &#x2018;<code class="Li">tileset.attrmap</code>&#x2019;.</p>
<p class="Pp"></p>
<div class="Bd Bd-indent"><code class="Li">$ rgbgfx -c '#ffffff,#8d05de,
  #dc7905,#000000; #fff,#8d05de, #7e0000 , #000' -A -o tileset.2bpp
  tileset.png</code></div>
<p class="Pp">TODO: more examples.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="BUGS"><a class="permalink" href="#BUGS">BUGS</a></h2>
<p class="Pp">Please report bugs and mistakes in this man page on
    <a class="Lk" href="https://github.com/gbdev/rgbds/issues">GitHub</a>. Bug
    reports and feature requests about RGBDS are also welcome!</p>
</section>
<section class="Sh">
<h2 class="Sh" id="SEE_ALSO"><a class="permalink" href="#SEE_ALSO">SEE
  ALSO</a></h2>
<p class="Pp"><a class="Xr" href="./rgbds.7">rgbds(7)</a>,
    <a class="Xr" href="./rgbasm.1">rgbasm(1)</a>,
    <a class="Xr" href="./rgblink.1">rgblink(1)</a>,
    <a class="Xr" href="./rgbfix.1">rgbfix(1)</a>,
    <a class="Xr" href="./gbz80.7">gbz80(7)</a></p>
<p class="Pp">The Game Boy hardware reference
    <a class="Lk" href="https://gbdev.io/pandocs/Rendering.html">Pan Docs</a>,
    particularly the section about graphics.</p>
</section>
<section class="Sh">
<h2 class="Sh" id="HISTORY"><a class="permalink" href="#HISTORY">HISTORY</a></h2>
<p class="Pp"><code class="Nm">rgbgfx</code> was originally created by
    <span class="An">stag019</span> to be included in RGBDS. It was later
    rewritten by <span class="An">ISSOtm</span>, and is now maintained by a
    number of contributors at
    <a class="Lk" href="https://github.com/gbdev/rgbds">https://github.com/gbdev/rgbds</a>.</p>
</section>
